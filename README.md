# merch-store

## POST | /api/auth 
Аутентификация и получение JWT-токена. 
При первой аутентификации пользователь создается автоматически.

+ Тело запроса (AuthRequest) должно содержать 
| Наименование | Тип     | Обязательность | Описание                             |
|--------------|---------|----------------|--------------------------------------|
| username     | string  | Да             | Имя пользователя для аутентификации. |
| password     | string  | Да             | Пароль для аутентификации.           |
|--------------------------------------------------------------------------------|

### 1. Пользователь существует. Логин и пароль верны -  200 OK
+ Тело ответа в случае успеха (AuthResponse) должно содержать 
| Наименование | Тип     | Обязательность | Описание                             |
|--------------|---------|----------------|--------------------------------------|
| token        | string  | Да             | JWT-токен для доступа к защищенным   |
|              |         |                | ресурсам.                            |
|--------------------------------------------------------------------------------|

### 2. Пользователь существует. Неправильный пароль: 401 Unauthorized
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неавторизован       |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 3. Регистрация пользователя. Успешный ответ: 201 Created (NEW)
+ Статус изменен, т.к. тут создается новый пользователь
Тело ответа в случае успеха (AuthResponse) должно cодержать токен, аналогично п.1.

### 4. Некорректное тело запроса - 400 Bad request
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неверный запрос.    |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 5. Прочие ошибки - 500 Internal Server Error
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Внутренняя ошибка   |
|           |         |           | описывающее проблему   | сервера.            |
|--------------------------------------------------------------------------------|

+ Каждому новому сотруднику выделяется 1000 монет, которые можно использовать для покупки товаров.

Сотрудников может быть до 100к


## POST | /api/buyItem (NEW)
Купить предмет за монеты. 

+ Количество монеток не может быть отрицательным, запрещено уходить в минус при операциях с монетками.

**Было GET | /api/buy/{item}.** Требования некорректны, т.к.запрос GET не должен изменять состояние на сервере. 
Наверное, правильнее реализовать:
1) GET | /api/items - получение списка всех предметов (как пользователь заранее узнает какие есть/доступны?)
2) POST | /api/items - добавление предмета
3) GET | /api/items/{item} - получение инфо о конкретном предмете
4) POST |/api/items/{item}/buy - купить конкретный предмет (но тогда надо сделать хотя бы п.3, а зачем делать то, что не требуется? :-) )

Поэтому для покупки решено использовать: **POST | /api/buyItem**

Тело запроса (buyItem) должно содержать 
| Наименование | Тип     | Обязательность | Описание                             |
|--------------|---------|----------------|--------------------------------------|
| item         | string  | Да             | Наименование предмета                |
|--------------------------------------------------------------------------------|

Тело ответа не предложено в требованиях, поэтому минимальная доработка - сообщить об успехе операции.

### 1. Предмет куплен. Успешный ответ: 201 Created
+ Статус изменен
+ Тело ответа в случае успеха должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| message   | string  | Да        | Сообщение об успешной  | Операция выполнена  |
|           |         |           | операции               | успешно             |
|--------------------------------------------------------------------------------|

### 2. Токен отсутствует или неверный. 401 Unauthorized
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неавторизован       |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 3. Некорректное тело запроса - 400 Bad request
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неверный запрос.    |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 4. Недостаточно коинов - 402 Payment Required (NEW)
+Новый код больше подходит, чем 400 или 500
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Недостаточно коинов |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 5. В запросе отправлен несуществующий предмет - 404 Not Found (NEW)
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Такой предмет не    |
|           |         |           | описывающее проблему   | найден              |
|--------------------------------------------------------------------------------|

### 6. Прочие ошибки - 500 Internal Server Error
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Внутренняя ошибка   |
|           |         |           | описывающее проблему   | сервера.            |
|--------------------------------------------------------------------------------|

## POST | /api/sendCoin
Отправить монеты другому пользователю.

Тело запроса должно содержать 
| Наименование | Тип     | Обязательность | Описание                             |
|--------------|---------|----------------|--------------------------------------|
| toUser       | string  | Да             | Имя пользователя, которому нужно     |
|              |         |                | отправить монеты                     |
|--------------------------------------------------------------------------------|
| amount       | integer | Да             | Количество монет, которые            |
|              |         |                | необходимо отправить.                |
|--------------------------------------------------------------------------------|

Количество монеток не может быть отрицательным, запрещено уходить в минус при операциях с монетками.

Тело ответа не предложено в требованиях, поэтому минимальная доработка - сообщить об успехе операции.

### 1. Коины отправлены. Успешный ответ: 201 Created (NEW)
+ Статус изменен
+ Тело ответа в случае успеха должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| message   | string  | Да        | Сообщение об успешной  | Операция выполнена  |
|           |         |           | операции               | успешно             |
|--------------------------------------------------------------------------------|

### 2. Токен отсутствует или неверный. 401 Unauthorized
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неавторизован       |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 3. Некорректное тело запроса - 400 Bad request
+ Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Неверный запрос.    |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 4. Недостаточно коинов - 402 Payment Required (NEW)
Новый код больше подходит, чем 400 или 500
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Недостаточно коинов |
|           |         |           | описывающее проблему   |                     |
|--------------------------------------------------------------------------------|

### 5. В запросе отправлен несуществующий получатель - 404 Not Found (NEW)
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Такой получатель не |
|           |         |           | описывающее проблему   | найден              |
|--------------------------------------------------------------------------------|

### 6. Прочие ошибки сервера - 500 Internal Server Error
Тело ответа в случае ошибки (ErrorResponse) должно содержать 
| Наименов. | Тип     | Обяз.     | Описание               | Текст               |
|-----------|---------|-----------|----------- ------------|---------------------|
| errors    | string  | Да        | Сообщение об ошибке,   | Внутренняя ошибка   |
|           |         |           | описывающее проблему   | сервера.            |
|--------------------------------------------------------------------------------|


## GET | /api/info
Получить информацию о монетах, инвентаре и истории транзакций.

Каждый сотрудник должен иметь возможность видеть:
- Сгруппированную информацию о перемещении монеток в его кошельке, включая:  
  - Кто ему передавал монетки и в каком количестве  
  - Кому сотрудник передавал монетки и в каком количестве

### 1. Успешный запрос, есть все объекты -  200 OK
### 2. + Токен отсутствует или неверный. 401 Unauthorized
### 3. Некорректный запрос - 400 Bad request
### 4. + inventory отсутствует - 200 OK, в теле нет 
### 5. coinHistory отсутствует - 200 OK, в теле нет 
### 6. coinHistory.received отсутствует - 200 OK, в теле нет 
### 7. coinHistory.sent отсутствует - 200 OK, в теле нет 
### 6. Прочие ошибки сервера - 500 Internal Server Error
